@using Strem.Core.Flows.Tasks
<Accordion Title="@Title" StyleType="is-info">
    <DynamicComponent Type="ComponentType" Parameters="GetProps()"></DynamicComponent>
    <div class="field is-grouped is-grouped-right">
        <div class="control">
            <button class="button is-danger" @onclick="() => OnRequestedDeletion.InvokeAsync(Data)">Delete Task</button>
        </div>
    </div>
</Accordion>

@code {

    [Parameter]
    public Type ComponentType { get; set; }
    
    [Parameter]
    public IFlowTaskData Data { get; set; }
    
    [Parameter] 
    public EventCallback<IFlowTaskData> OnRequestedDeletion { get; set; }
    
    [Parameter]
    public string Title { get; set; }
    
    public Dictionary<string, object> GetProps() => new() {
        {"Data", Data },
        {"OnTitleChanged", EventCallback.Factory.Create<string>(this, OnTitleChanged)}
    };

    public void OnTitleChanged(string newTitle)
    {
        Title = newTitle;
    }
}